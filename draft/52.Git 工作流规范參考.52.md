# 52.Git 工作流规范參考.52
## <a name="index"></a> 目录
- [引子](#start)
- [介绍](#style)
- [什么是成功的 Git 工作流](#what)
- [Git 工作流](#git)
- [GitHub 工作流](#github)
- [GitLab 工作流](#gitlab)
- [规范参考](#standard)
  - [问题12](#link)
- [参考资料](#reference)


## <a name="start"></a> 引子
本以为使用 Git 的工作流规范依据很普遍了，发现事实并不是那样。找了些资料，结合实际的工作情况，进行了整合。

## <a name="intro"></a> 介绍
Git 工作流是一个如何使用 Git 以一致和高效的方式来完成工作的建议。在 Git 管理的项目中与团队合作时，确保团队对如何应用工作流达成一致意见是很重要的。在看下面介绍的内容时，请记住，这些工作流是一个指导原则，而不是具体的规则。可以根据自身实际情况进行相应调整。


## <a name="what"></a> 什么是成功的 Git 工作流
当评估团队工作流时，考虑团队的文化是最重要的一件事。你希望工作流提高团队的效率，而不是成为限制生产力的负担。当评估时可以考虑的事情：
- 此工作流是否随团队规模而扩展？
- 此工作流是否可以轻松撤消失误和错误？
- 此工作流是否会给团队带来任何新的不必要的认知开销？

下面就来比较一下常见的 Git 工作流。

## <a name="git"></a> Git 工作流
详细介绍见 [Git branching model][url-segment-68] 。

优点：
- 很早就提出，很多人基本都多少有了解这套流程。
- 特定的分支分工明确，相互独立，减少了意外发布到线上的情况。
- 总有一个可以马上发布到线上的分支。


缺点：
- 接受成本相对较高。
- 当项目开发规模扩大复杂后，可能会同时出现开发、待发布、热修复、发布交叉的情况，这个时候可能会相互牵制，容易混淆。
- 分支相对过多，发布到线上整个构建周期相对较长。


## <a name="github"></a> GitHub 工作流
详细介绍见 [GitHub flow][url-segment-69] 。

优点：
- 主要有 feature 分支和 master，发布到线上更加简化。
- 修复问题可以直接在 feature 上持续进行，减少了一些合并提交的开销。
- 总有一个可以马上发布到线上的分支。


缺点：
- 在 feature 合并到 master 之前，feature 分支需要发布到一个线上环境验证，也就是说可能同时存在多个线上环境，这可能需要额外的开销。
- 开发的功能很多时，合并到 master 时相互之间出现冲突可能性更高。

## <a name="gitlab"></a> GitLab 工作流
详细介绍见 [GitLab Flow][url-segment-80] 。

优点：
- 相对灵活，可以马上发布上线，也可以增加之间的步骤。
- 着重使用 issue 的方式，减轻了项目管理上的工作，让每一个开发人员能够有意识自我管理。
- 文档中说明涉及的方面相对比较全面。
- 总有一个可以马上发布到线上的分支。


缺点：
- 由于相对灵活，没有一些统一的硬性规定，那么分支和环境的管理就会相对复杂一些。
- 强调与 GitLab 平台的结合，如果换了其它平台，可能需要一些转换接受成本。
- 希望适应更多的情况，也给出了多种情况的示例，过多选择，导致需要再次考虑，反而会产生没有通用遵循规范的感觉。

## <a name="standard"></a> 规范参考
根据上面的几种工作流，以及个人在实际工作中碰到的情况，对于规范有下面的一些想法。

个人印象比较深刻的是，服务器的资源很大的影响了可用的环境，因此以运行环境作为一个切入点。

### 环境划分
一般有开发环境、测试环境、生产环境，下面说下每个环境的特点。

### 分支策略

### 修复 bug 策略

### 异常情况处理

## 规范参考简化版

## 规范参考增强版



每一个环境一般对应一个特定固定的 Git 分支：
- 开发环境对应 develop 分支
- 测试环境对应 release 分支
- 生产环境对应 master 分支

### 开发环境


<div align="right"><a href="#index">Back to top :arrow_up:</a></div>

## <a name="reference"></a> 参考资料
- [A successful Git branching model][url-reference-4]
- [GitHub flow][url-article-1]
- [GitLab Flow][url-article-2]
- [Comparing Workflows][url-article-3]

[url-base]:https://xxholic.github.io/blog/draft

[url-article-1]:https://guides.github.com/introduction/flow/index.html
[url-article-2]:https://docs.gitlab.com/ee/topics/gitlab_flow.html
[url-article-3]:https://www.atlassian.com/git/tutorials/comparing-workflows
[url-article-4]:https://nvie.com/posts/a-successful-git-branching-model/

[url-segment-68]:https://github.com/XXHolic/segment/issues/78
[url-segment-69]:https://github.com/XXHolic/segment/issues/79
[url-segment-70]:https://github.com/XXHolic/segment/issues/80

[url-local-1]:./images/52/git-model.png
[url-local-2]:./images/52/centr-decentr.png

<details>
<summary>:wastebasket:</summary>


最近在看[《黑暗的左手》][url-book]，里面关于性的设定很有意思，在书中描述的星球上，是没有性别区分的。下面是书中部分摘录。



![49-poster][url-local-poster]

</details>

[url-book]:https://book.douban.com/subject/26916012/
[url-local-poster]:./images/49/poster.jpg
