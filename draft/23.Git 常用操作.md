# Git 常用操作
## 目录
- [想法](#think)
- [Git 是什么？](#what)
- [Git 中的状态](#states)
- [Git 基本工作流程](#process)
- [Git 操作](#operate)
  - [git clone](#clone)
  - [git config](#config)
  - [git remote](#remote)
  - [git add](#add)
  - [git commit](#commit)
  - [git push](#push)
  - [git pull](#pull)
- [参考资料](#reference)
## <a name="think"></a> 想法
看了自己曾经学习 Git 时的笔记，结合实际工作中的使用，发现有些自己都没有怎么用过。时间长了，想查找的时候，不太好找到自己想要的部分，于是就在此记录一下个人常用的操作。随着实际的接触，不断的补充完善，印象会更加深刻一些。

## <a name="what"></a> Git 是什么？
Git 是一个免费开源的分布式版本控制系统。无论大小项目，它可以高效快速管理版本相关的事情，例如跟踪记录每一个项目文件的变动。比较有意思的是名称“Git”翻译过来是“饭桶，无用的人”的意思。具体为什么这么命令及Git的发展历史，见[Git][url-wiki-git]。

## <a name="states"></a> Git 中的状态
Git 有三种主要状态，文件可能处于其中之一：已提交（committed）、已修改（modified）和已暂存（staged）。
- 已提交表示数据已经安全的保存在本地数据库中。
- 已修改表示修改了文件，但还没保存到数据库中。
- 已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。

由此引入 Git 项目的三个工作区域的概念：Git 仓库、工作目录以及暂存区域。
- Git 仓库目录是 Git 用来保存项目的元数据和对象数据库的地方。 这是 Git 中最重要的部分，从其它计算机克隆仓库时，拷贝的就是这里的数据。
- 工作目录是对项目的某个版本独立提取出来的内容。 这些从 Git 仓库的压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。
- 暂存区域是一个文件，保存了下次将提交的文件列表信息，一般在 Git 仓库目录中。 有时候也被称作`‘索引’'，不过一般说法还是叫暂存区域。

![23-area][url-23-areas]

使用 Git 时文件的状态变化周期如下：

![23-lifecycle][url-23-lifecycle]

## <a name="process"></a> Git 基本工作流程
基本的 Git 工作流程如下：
1. 如果已有远程库，克隆库到本地，否则初始化一个新库。
2. 在工作目录中修改文件。
3. 暂存文件，将文件的快照放入暂存区域。
4. 提交更新，找到暂存区域的文件，将快照永久性存储到 Git 仓库目录。
5. 推送到远程的仓库。

![23-process][url-23-process]

## <a name="operate"></a> Git 操作
### <a name="clone"></a> git clone
从远程克隆一个仓库。
```shell
git clone <repository> [<directory>]
```
会在本地生成一个目录，名称跟远程仓库同名。如果要指定到特定的目录下，使用下面的格式。
```shell
git clone <repository> <directory>
```
`directory` 如果本地存在，就会直接将远程库里面的内容克隆进去，如果不存在，就会新建一个对应的目录，然后克隆进去。也算是远程仓库的别名。

Git 支持多种数据传输协议。这里要提一下 ssh 和 https 两种格式。
- ssh：克隆的项目必须是拥有者或管理员，而且在克隆前需要添加 ssh key。ssh 在 push 的时候默认是不需要密码的，如果设置了密码就需要输密码。现在不推荐使用这种方式。
- https：所有的人都可以克隆，但在 pull/push 的时候需要验证用户名和密码，就是登录对应平台（例如github、gitlab）的帐号和密码。这个是现在推荐的方式。

https 方式默认每次都要输入密码，想要记住第一次输入的密码，需要设置 config 对应配置项。
```shell
git config --global credential.helper store
```

### <a name="config"></a> git config
1、查看所有的配置信息 <br />
```shell
git config --global credential.helper store
```

2、配置账户信息 <br />
在教程里面基本都是先配置全局信息。
```shell
git config --global user.name "thy"

git config --global user.email 1766970236@qq.com
```
这样设置后，如果没有单独设置，所有的仓库默认会用这些信息。最好是最常用的账户信息。如果提交记录需要用不同的账户，那么可能就要分别进行设置。

`config` 配置一般有三个级别：system、global、local。Git 读取配置的顺序是 system->global->local，后面的权重更大，相同权重时，后执行的配置会覆盖前面的配置。所以想要用另外的账号，到对应仓库下重新执行上面命令，不同的是把关键字 `global` 换成 `local`。

### <a name="remote"></a> git remote
1、查看仓库的地址<br />
```shell
git remote -v
```
![23-remote-1][url-23-remote-1]
2、修改仓库 origin 的地址<br />
```shell
git remote set-url origin <newurl>
```
3、查看远程仓库的情况<br />
```shell
git remote show origin
```
![23-remote-3][url-23-remote-3]

里面提示 remove 的分支表示远程已经删除了，所以可以用这种方式判断自己本地那些分支跟远程分支对应情况。根据提示执行命令即可。
```shell
git remote prune origin
```

### <a name="add"></a> git add
这个命令会将修改或新增的文件内容被写入到对象库中的一个新的对象中，该对象的 ID 会被记录在暂存区的文件索引，目录树会相应的更新。<br />
1、将所有修改或新增的文件放入暂存区命令 <br />
```shell
git add .
```
2、将指定修改或新增的文件放入到暂存区 <br />
例如只将 text.txt 文件的修改放入暂存区：
```shell
git add text.txt
```

### <a name="commit"></a> git commit
这个命令会将缓存区的内容添加到本地的仓库中。一般都是要添加相应的说明。
```shell
git commit -m "add new file"
```

### <a name="push"></a> git push
该命令用于将本地分支的更新，推送到远程仓库。
```shell
git push
```
这样直接执行该命令，不加其它任何参数时，如果远程存在与其有“追踪关系”的分支（通常两者名称相同），那么就会推送到对应远程分支；否则，就会出现下面的提示信息。按照提示执行就可以了。

![23-push-1][url-23-push-1]

较完整的命令格式为：
```shell
git push <远程仓库名> <本地分支名>:<远程分支名>
git push origin develop:develop
```
上面示例表示，将本地的 develop 分支推动到远程 origin 的 develop 分支。如果远程的 develop 分支不存在，则会被新建并产生“追踪关系”。远程分支名可以省略。

### <a name="pull"></a> git pull
该命令的作用是，取回远程仓库某个分支的更新，再与本地的指定分支合并。
```shell
git pull
```
上面命令表示，当前分支自动与唯一一个追踪分支进行合并。

较完整的命令格式为：
```shell
git pull <远程仓库名> <远程分支名>:<本地分支名>
git push origin develop:feature
```
上面示例表示，取回 origin 的 develop 分支，与本地的 feature 分支合并。

## <a name="reference"></a> 参考资料
- [Git](https://git-scm.com/)
- [Git book](https://git-scm.com/book/en/v2)
- [wiki-Git][url-wiki-git]
- [Git远程操作详解][http://www.ruanyifeng.com/blog/2014/06/git_remote.html]
- [Git教程](https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)


<!-- Git 是什么？ -->
[url-wiki-git]:https://en.wikipedia.org/wiki/Git

<!-- Git 中的状态 -->
[url-23-areas]:./images/23/23-areas.png
[url-23-lifecycle]:./images/23/23-lifecycle.png
[url-23-process]:./images/23/23-process.png
[url-23-remote-1]:./images/23/23-remote-1.png
[url-23-remote-3]:./images/23/23-remote-3.png
[url-23-push-1]:./images/23/23-push-1.png





